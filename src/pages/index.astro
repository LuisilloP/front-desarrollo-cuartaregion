---
import Layout from "../layouts/Layout.astro";
import Navbar from "../components/Navbar.astro";
import Hero from "../components/Hero.astro";
import ServicesSection from "../components/ServicesSection.astro";
import HostingSection from "../components/HostingSection.astro";
import CasesSection from "../components/CasesSection.astro";
import ReviewsSection from "../components/ReviewsSection.astro";
import FAQSection from "../components/FAQSection.astro";
import Footer from "../components/Footer.astro";
import WhatsAppFloatingButton from "../components/WhatsAppFloatingButton.astro";
import {
  fetchCases,
  fetchFaqs,
  fetchFeaturedServices,
  fetchTestimonials,
  fetchSiteSettings
} from "../lib/api/services";

const [siteSettings, featuredServices, cases, testimonials, faqs] = await Promise.all([
  fetchSiteSettings(),
  fetchFeaturedServices(),
  fetchCases(),
  fetchTestimonials(),
  fetchFaqs()
]);

const recentCases = cases.slice(0, 3);
---

<Layout title={siteSettings.siteName} description={siteSettings.tagline} siteSettings={siteSettings}>
  <Navbar siteSettings={siteSettings} />
  <main class="space-y-8">
    <Hero siteSettings={siteSettings} />
    <ServicesSection services={featuredServices} whatsappNumber={siteSettings.whatsappNumber} />
    <HostingSection siteSettings={siteSettings} />
    <CasesSection cases={recentCases} />
    <ReviewsSection reviews={testimonials} />
    <FAQSection faqs={faqs} />
  </main>
  <Footer siteSettings={siteSettings} />
  <WhatsAppFloatingButton whatsappNumber={siteSettings.whatsappNumber} message="Hola! Quiero cotizar mi web con ustedes." />
</Layout>
