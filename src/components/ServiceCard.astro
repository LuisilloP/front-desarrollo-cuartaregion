---
import type { Service } from "../data/mock";
import { buildWhatsAppLink, formatCLP } from "../lib/utils";

interface Props {
  service: Service;
  whatsappNumber: string;
}

const { service, whatsappNumber } = Astro.props;
const whatsappUrl = buildWhatsAppLink(whatsappNumber, `Hola! Me interesa el plan ${service.name}.`);
---

<article
  class={`card h-full flex flex-col gap-4 ${service.isFeatured ? "border-primary/60 bg-white dark:bg-slate-900/80" : ""}`}
>
  <div class="flex items-start justify-between gap-3">
    <div class="space-y-1">
      <h3 class="text-xl font-semibold text-slate-900 dark:text-white">{service.name}</h3>
      <p class="text-sm text-highlight">{service.idealFor}</p>
    </div>
    {service.isFeatured && (
      <span class="px-3 py-1 text-xs rounded-full bg-primary/15 text-highlight border border-primary/40">
        Recomendado
      </span>
    )}
  </div>

  <p class="text-slate-700 dark:text-slate-300 text-sm leading-relaxed min-h-[84px]">
    {service.description}
  </p>

  <div class="space-y-1">
    <p class="text-xs uppercase tracking-wide text-slate-500 dark:text-slate-400">Desde</p>
    <p class="text-3xl font-bold text-slate-900 dark:text-white">{formatCLP(service.priceCLP)}</p>
  </div>

  <ul class="space-y-2 text-sm text-slate-700 dark:text-slate-200 flex-1 min-h-[120px]">
    {service.features?.map((feature) => (
      <li class="flex items-start gap-2">
        <span class="mt-0.5 h-2 w-2 rounded-full bg-accent"></span>
        {feature}
      </li>
    ))}
  </ul>

  <a
    href={whatsappUrl}
    target="_blank"
    rel="noreferrer"
    class="inline-flex items-center gap-2 px-4 py-3 rounded-full bg-gradient-to-r from-primary to-accent text-secondary font-semibold shadow-soft hover:shadow-lg transition w-full text-center justify-center"
  >
    Cotizar ahora
  </a>
</article>
